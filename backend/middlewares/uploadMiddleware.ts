// ============================================================================
// middlewares/uploadMiddleware.ts - "ПРОФЕССИОНАЛЬНЫЙ ГРУЗЧИК" (Multer Middleware)
// ============================================================================
// Этот файл содержит middleware-функцию, которая использует настроенный `multer`
// для обработки загрузки ОДНОГО файла за раз.
//
// Он выступает как "интерфейс" между входящим запросом и логикой сохранения файла.
// ============================================================================

// --- 1. ИМПОРТЫ ---
import { upload } from "../config/multer";
// Импортируем настроенный экземпляр multer из файла конфигурации.
// Это гарантирует, что везде используется ОДИНАКОВАЯ логика настройки.

// ============================================================================
// --- MIDDLEWARE `uploadSingleImage` ---
// ============================================================================
/**
 * Middleware для загрузки одного файла.
 *
 * Метафора: Это "специализированный грузчик", который умеет работать только
 * с одной коробкой (`"file"`) за раз, но делает это отлично, следуя всем
 * инструкциям из `config/multer.ts` (куда положить, как назвать, какой размер).
 *
 * Как это используется:
 * При создании маршрута для загрузки файла, мы добавляем эту функцию
 * в цепочку обработки:
 *
 * router.post('/', uploadSingleImage, (req, res) => {
 *   // Если uploadSingleImage прошел успешно, req.file будет содержать
 *   // информацию о загруженном файле.
 *   if (req.file) { ... }
 * });
 */
export const uploadSingleImage = upload.single("file");
