# Инструкции AGENTS для `nabludatel-platform`

Этот репозиторий — монорепозиторий, содержащий несколько пакетов и приложений на Node.js/TypeScript.
Структура проекта:

- `admin/` – React-панель администратора, собранная с помощью Vite.
- `backend/` – сервер API на Express, хранящий данные в JSON-файлах.
- `apps/kyanchir/` – небольшой сервер для рендеринга статических сайтов с использованием UI-пакета.
- `packages/`
  - `core/` – общие интерфейсы TypeScript и утилиты.
  - `ui/` – библиотека компонентов UI на React.
- `core/` – дополнительные утилиты (информация о проекте, помощник для slug'ов).
- `scripts/` – вспомогательные скрипты для разработки (баннеры, логи).

## Как это работает

1. **Backend** (`backend/`)
   - Запускает Express-сервер на порту 3001.
   - Хранит данные пользователей и сайтов в файлах `backend/db/*.json`.
   - Предоставляет REST API по маршрутам `/api/*` для пользователей, авторизации, загрузок и сайтов.
   - Использует простую JWT-аутентификацию (middleware в `backend/middlewares/`).
   - Загруженные файлы сохраняются в `backend/uploads/` и раздаются как статика.

2. **Admin** (`admin/`)
   - SPA на Vite + React для управления пользователями/сайтами.
   - Обменивается данными с backend через `fetch`-запросы.
   - Использует Tailwind для стилей. Точка входа: `admin/src/main.tsx`.

3. **UI-пакет** (`packages/ui`)
   - Содержит переиспользуемые React-компоненты (шапка, карточка товара и т.д.).
   - Используется другими приложениями, такими как `kyanchir`.

4. **Kyanchir** (`apps/kyanchir`)
   - Минималистичный сервер на Express/React для отображения витрины, используя компоненты
     из UI и данные из `packages/core`.

5. **Core-утилиты** (`core/` и `packages/core`)
   - Предоставляют небольшие помощники, такие как `slugify` и `project.ts` с git-метаданными.

## Разработка

- Установите зависимости с помощью `pnpm install`.
- Запустите `pnpm dev`, чтобы поднять все приложения через Turborepo (admin + backend).
- Скрипты backend находятся в `scripts/`. Скрипт `printServerStop.ts` выводит информацию при завершении работы сервера.

В настоящее время автоматические тесты отсутствуют. При внесении изменений убедитесь, что команда
`npx tsc -p backend/tsconfig.json --noEmit` не вызывает новых ошибок.
Если при работе с проектом обнаруживается, что документация устарела или неполна, обновляйте соответствующие файлы в том же PR.
